{{ $newYear := sub .Site.Params.year 1 }}

{{ $yrs := slice }}
  {{ range .Site.Data.Masterlist }}
    {{ range where .contents ".Year" ">=" $newYear }}
      {{ $yrs = $yrs | append .Year }}
    {{ end }}
  {{ end }}
{{ $yrs = uniq $yrs }}

{{ $yrsDesc := sort $yrs "value" "desc" }}
{{ $lastYr := index (last 1 $yrs) 0 }}

<!-- tabs -->
<div class="tab"> <!-- // horizontal scroll -->
  {{ range $yrsDesc }}
    {{ $year := . }}
      <button id="B{{ $year }}" onclick="openTab(event, '{{ $year }}', 'tc1', 'tb1')"
      class="tb1 tablinks {{ if eq $year $lastYr }} active {{ end }}">{{ $year }}
      </button>
  {{ end }}
</div>

<!-- tab content -->
{{ range $yrsDesc }}
    {{ $year := . }}

  <div id="{{ $year }}" class="tc1 tabcontent {{ if eq $year $lastYr }} active {{ end }}">
  <!-- Summarized -->


  <!-- // by date -->
  <span style="padding-top:10px" id="{{$year}}-newest">&nbsp;</span><br>
  <a href="#{{$year}}-oldest"><button class="anchor" >Jump to oldest</button></a>

  {{ $dateOrder := "desc" }}

      {{ $months := slice }}
        {{ range $.Site.Data.Masterlist }}
            {{ range sort (where .contents "Year" $year) "Date" $dateOrder }}
            {{ $months = $months | append .Month }}
            {{ end }}
        {{ end }}
      {{ $months = uniq $months }}

      {{ range $months }}
        {{ $month := . }} <br>

        {{ range $.Site.Data.Masterlist }}
          {{ range sort (sort (where (where .contents "Year" $year) "Month" $month) "ID" "desc" ) "Date" $dateOrder }} <!-- // order changable to asc and desc -->
          <div class="link-list">
            <ul>
              <span class="date">{{ dateFormat "Jan 02" .Date }}</span>
              <span id="catlink"><a href="{{ .CatLink }}">{{ .Category }}
                {{ if and (ne .SubCat "-") (ne .SubCat "Others")}}
                : {{ .SubCat }}
                {{end}}</a></span>

              {{ .Title }}
              {{ range .Links }}
              â˜… <a target="_blank" href="{{ .Link }}">{{ .Name }}</a> <span class="subs">{{ .Subs }}</span>
              {{ end }} <!-- range .Links -->
            </ul>
          </div>
          {{ end }} <!-- range sort -->
        {{ end }} <!-- range masterlist -->
      {{ end }} <br> <!-- range months -->

      <a id="{{$year}}-oldest" href="#{{$year}}-newest"><button class="anchor" >Jump to newest</button></a>
    </div> <!-- .tab-content -->
{{ end }} <!-- range years-->
